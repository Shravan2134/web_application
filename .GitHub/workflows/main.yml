name: build and deploy the web_application

on:
   push:
        branches:
        - main

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - name: checkout repository
              uses: actions/checkout@v2

            - name: setup node
              uses: actions/setup-node@v2
              with:
                  node-version: '14'
                  
            - name : install dependencies
              run: npm install
              
            - name: build the docker image 
               run: docker build -t web_application .
               
            - name: login to docker hub
              uses: docker/login-action@v2
                with:
                    username: ${{ secrets.DOCKERHUB_USERNAME }}
                    password: ${{ secrets.DOCKERHUB_TOKEN }}


            - name: push the docker image
              run: docker tag web_application ${{ secrets.DOCKERHUB_USERNAME }}/web_application
              run: docker push ${{ secrets.DOCKERHUB_USERNAME }}/web_application

    